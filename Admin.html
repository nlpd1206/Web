<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Rainbow Shop - Qu·∫£n l√Ω</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .user-actions {
      display: flex;
      align-items: center;
      gap: 25px;
    }
    
    .user-action {
      color: white;
      text-decoration: none;
      font-size: 14px;
      transition: opacity 0.3s;
    }
    
    .user-action:hover {
      opacity: 0.8;
    }
    
    /* Layout ch√≠nh */
    .main-container {
      display: flex;
      margin: 20px;
      gap: 20px;
    }
    
    /* Danh m·ª•c */
    .category-sidebar {
      width: 250px;
      padding: 20px;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .category-sidebar h3 {
      margin-bottom: 15px;
      color: #6a5acd;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .category-sidebar ul {
      list-style: none;
    }
    
    .category-sidebar li {
      margin-bottom: 10px;
    }
    
    .category-sidebar a {
      color: #333;
      text-decoration: none;
      padding: 8px 12px;
      display: block;
      border-radius: 5px;
      transition: all 0.3s;
    }
    
    .category-sidebar a:hover,
    .category-sidebar a.active {
      background-color: #6a5acd;
      color: white;
    }
    
    /* Ph·∫ßn qu·∫£n l√Ω s·∫£n ph·∫©m */
    .admin-content {
      flex: 1;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 25px;
    }
    
    /* Form th√™m s·∫£n ph·∫©m */
    .product-form {
      margin-bottom: 30px;
      padding: 20px;
      background: #f9f9f9;
      border-radius: 8px;
      border: 1px solid #eee;
    }
    
    .form-row {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
    }
    
    .form-row .form-group {
      flex: 1;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #555;
    }
    
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      transition: border 0.3s;
    }
    
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      border-color: #6a5acd;
      outline: none;
    }
    
    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    .form-actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    
    .btn {
      padding: 10px 18px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s;
    }
    
    .btn-primary {
      background-color: #6a5acd;
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #5a4abd;
    }
    
    .btn-secondary {
      background-color: #f0f0f0;
      color: #333;
    }
    
    .btn-secondary:hover {
      background-color: #e0e0e0;
    }
    
    .btn-reset {
      background-color: transparent;
      color: #6a5acd;
      border: 1px solid #6a5acd;
    }
    
    .btn-reset:hover {
      background-color: #f0eefc;
    }
    
    /* Danh s√°ch s·∫£n ph·∫©m */
    .product-list-admin {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
      align-items: stretch;
    }
    
    .product-card-admin {
      background: white;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border: 1px solid #eee;
      display: flex;
      flex-direction: column;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    
    .product-card-admin:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .product-card-admin img {
      width: 100%;
      height: 180px;
      object-fit: contain;
      border-radius: 4px;
      margin-bottom: 15px;
      background: #f5f5f5;
    }
    
    .product-info {
      flex-grow: 1;
      margin-bottom: 15px;
    }
    
    .product-card-admin h4 {
      margin: 0 0 8px;
      font-size: 16px;
      color: #333;
    }
    
    .product-card-admin .price {
      color: #d0011b;
      font-weight: bold;
      margin-bottom: 8px;
      font-size: 15px;
    }
    
    .product-card-admin .category {
      color: #666;
      font-size: 13px;
      margin-bottom: 8px;
    }
    
    .product-card-admin .stock {
      color: #666;
      font-size: 13px;
    }
    
    .product-actions {
      display: flex;
      gap: 10px;
      margin-top: auto;
    }
    
    .btn-edit {
      background-color: #ffc107;
      color: #333;
    }
    
    .btn-edit:hover {
      background-color: #e0a800;
    }
    
    .btn-delete {
      background-color: #dc3545;
      color: white;
    }
    
    .btn-delete:hover {
      background-color: #c82333;
    }
    
    /* B·ªô l·ªçc v√† t√¨m ki·∫øm */
    .filter-section {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      gap: 15px;
    }
    
    .search-box {
      display: flex;
      flex: 1;
      max-width: 400px;
    }
    
    .search-box input {
      flex: 1;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 4px 0 0 4px;
      font-size: 14px;
    }
    
    .search-box button {
      padding: 0 15px;
      background-color: #6a5acd;
      color: white;
      border: none;
      border-radius: 0 4px 4px 0;
      cursor: pointer;
    }
    
    #sortProducts {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }
    
    /* Ph√¢n trang */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin-top: 30px;
    }
    
    .pagination button {
      padding: 8px 15px;
      background-color: #6a5acd;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .pagination button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }
    
    .modal-content {
      background-color: #fff;
      margin: 15% auto;
      padding: 25px;
      border-radius: 8px;
      width: 400px;
      max-width: 90%;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 25px;
    }
    
    .close-modal {
      float: right;
      font-size: 24px;
      cursor: pointer;
      color: #aaa;
    }
    
    .close-modal:hover {
      color: #333;
    }
    
    /* Th√¥ng b√°o */
    .notification {
      display: none;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    .notification.success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .notification.error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    /* Responsive */
    @media (max-width: 992px) {
      .main-container {
        flex-direction: column;
      }
      
      .category-sidebar {
        width: 100%;
        margin-bottom: 20px;
      }
      
      .form-row {
        flex-direction: column;
        gap: 0;
      }
    }
    
    @media (max-width: 576px) {
      .filter-section {
        flex-direction: column;
      }
      
      .search-box {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <a href="TrangChu.html" style="text-decoration: none;">
      <span class="rainbow-text">Rainbow</span>
    </a>
  </div>
  
  <!-- Main content -->
  <div class="main-container">
    
    <!-- N·ªôi dung qu·∫£n l√Ω -->
    <div class="admin-content">
      <h1>Qu·∫£n l√Ω s·∫£n ph·∫©m</h1>
      
      <!-- Th√¥ng b√°o -->
      <div id="notification" class="notification" style="display:none;"></div>
      
      <!-- Form th√™m/s·ª≠a s·∫£n ph·∫©m -->
      <form id="productForm" class="product-form">
        <input type="hidden" id="productId">
        
        <div class="form-row">
          <div class="form-group">
            <label for="productName">T√™n s·∫£n ph·∫©m <span class="required">*</span></label>
            <input type="text" id="productName" required>
          </div>
          
          <div class="form-group">
            <label for="productPrice">Gi√° (VNƒê) <span class="required">*</span></label>
            <input type="number" id="productPrice" required min="1000">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="productCategory">Danh m·ª•c <span class="required">*</span></label>
            <select id="productCategory" required>
              <option value="">-- Ch·ªçn danh m·ª•c --</option>
              <option value="dienthoai">ƒêi·ªán tho·∫°i</option>
              <option value="quanao">Qu·∫ßn √°o</option>
              <option value="giaydep">Gi√†y d√©p</option>
              <option value="phukien">Ph·ª• ki·ªán</option>
              <option value="khac">Kh√°c</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="productStock">S·ªë l∆∞·ª£ng t·ªìn kho <span class="required">*</span></label>
            <input type="number" id="productStock" required min="0" value="0">
          </div>
        </div>
        
        <div class="form-group">
          <label for="productImage">H√¨nh ·∫£nh <span class="required">*</span></label>
          <div class="image-upload-container">
            <input type="file" id="productImage" accept="image/*" required>
            <label for="productImage" class="upload-label">
              <span id="fileName">Ch·ªçn ·∫£nh...</span>
              <i class="upload-icon">üìÅ</i>
            </label>
            <div id="imagePreview" class="image-preview">
              <img id="previewImage" style="display:none;">
              <span id="removeImage" style="display:none;">‚úñ</span>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="productDesc">M√¥ t·∫£ s·∫£n ph·∫©m</label>
          <textarea id="productDesc" rows="4"></textarea>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="productColors">M√†u s·∫Øc (ngƒÉn c√°ch b·∫±ng d·∫•u ph·∫©y)</label>
            <input type="text" id="productColors" placeholder="V√≠ d·ª•: ƒê·ªè,Xanh,ƒêen">
          </div>
          
          <div class="form-group">
            <label for="productSizes">K√≠ch c·ª° (ngƒÉn c√°ch b·∫±ng d·∫•u ph·∫©y)</label>
            <input type="text" id="productSizes" placeholder="V√≠ d·ª•: S,M,L,XL">
          </div>
        </div>
        
        <div class="form-actions">
          <button type="submit" class="btn btn-primary" id="submitBtn">Th√™m s·∫£n ph·∫©m</button>
          <button type="button" class="btn btn-secondary" id="cancelEdit" style="display:none;">H·ªßy b·ªè</button>
          <button type="reset" class="btn btn-reset">L√†m m·ªõi</button>
        </div>
      </form>
      
      <!-- B·ªô l·ªçc v√† t√¨m ki·∫øm -->
      <div class="filter-section">
        <div class="search-box">
          <input type="text" id="searchProduct" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m...">
          <button id="searchBtn">üîç</button>
        </div>
        <select id="sortProducts">
          <option value="newest">M·ªõi nh·∫•t</option>
          <option value="oldest">C≈© nh·∫•t</option>
          <option value="price_asc">Gi√° tƒÉng d·∫ßn</option>
          <option value="price_desc">Gi√° gi·∫£m d·∫ßn</option>
        </select>
      </div>
      
      <!-- Danh s√°ch s·∫£n ph·∫©m -->
      <div class="product-list-container">
        <h2>Danh s√°ch s·∫£n ph·∫©m <span id="productCount">(0 s·∫£n ph·∫©m)</span></h2>
        
        <div class="product-list-admin" id="productList">
          <!-- S·∫£n ph·∫©m s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
          <div class="no-products">
            <img src="img/no-products.png" alt="No products">
            <p>Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o</p>
            <button class="btn btn-primary" onclick="document.getElementById('productForm').scrollIntoView()">Th√™m s·∫£n ph·∫©m m·ªõi</button>
          </div>
        </div>
        
        <!-- Ph√¢n trang -->
        <div class="pagination" id="pagination" style="display:none;">
          <button id="prevPage">‚Üê Tr∆∞·ªõc</button>
          <span id="pageInfo">Trang 1/1</span>
          <button id="nextPage">Sau ‚Üí</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Footer -->
    <div class="footer">
    <div class="contact-info">Th√¥ng tin li√™n h·ªá: 1900 1000</div>
    <p>¬© 2025 Rainbow Shop</p>
  </div>

  <!-- Modal x√°c nh·∫≠n x√≥a -->
  <div id="confirmModal" class="modal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h3>X√°c nh·∫≠n x√≥a s·∫£n ph·∫©m</h3>
      <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫£n ph·∫©m n√†y?</p>
      <div class="modal-actions">
        <button id="confirmDelete" class="btn btn-danger">X√≥a</button>
        <button id="cancelDelete" class="btn btn-secondary">H·ªßy</button>
      </div>
    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    // Ki·ªÉm tra ƒëƒÉng nh·∫≠p
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    if (!currentUser || currentUser.role !== 'seller') {
      alert('B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p trang n√†y!');
      window.location.href = 'TrangChu.html';
      return;
    }

    // Kh·ªüi t·∫°o
    let products = JSON.parse(localStorage.getItem('products')) || [];
    let editingProductId = null;
    let currentPage = 1;
    const productsPerPage = 10; // Hi·ªÉn th·ªã 10 s·∫£n ph·∫©m m·ªói trang
    let filteredProducts = [...products];
    let currentProductIdToDelete = null;

    // DOM Elements
    const productForm = document.getElementById('productForm');
    const productList = document.getElementById('productList');
    const notification = document.getElementById('notification');
    const productCount = document.getElementById('productCount');
    const pagination = document.getElementById('pagination');
    const pageInfo = document.getElementById('pageInfo');
    const searchInput = document.getElementById('searchProduct');
    const sortSelect = document.getElementById('sortProducts');
    const imageInput = document.getElementById('productImage');
    const previewImage = document.getElementById('previewImage');
    const fileName = document.getElementById('fileName');
    const removeImage = document.getElementById('removeImage');
    const confirmModal = document.getElementById('confirmModal');
    const confirmDeleteBtn = document.getElementById('confirmDelete');
    const cancelDeleteBtn = document.getElementById('cancelDelete');
    const closeModalBtn = document.querySelector('.close-modal');

    // Hi·ªÉn th·ªã s·∫£n ph·∫©m ban ƒë·∫ßu
    renderProducts();

    // X·ª≠ l√Ω upload ·∫£nh
    imageInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        fileName.textContent = file.name;
        const reader = new FileReader();
        reader.onload = function(e) {
          previewImage.src = e.target.result;
          previewImage.style.display = 'block';
          removeImage.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    });

    // X√≥a ·∫£nh preview
    removeImage.addEventListener('click', function() {
      imageInput.value = '';
      previewImage.src = '';
      previewImage.style.display = 'none';
      fileName.textContent = 'Ch·ªçn ·∫£nh...';
      removeImage.style.display = 'none';
    });

    // Submit form
    productForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // Validate form
      const name = document.getElementById('productName').value.trim();
      const price = document.getElementById('productPrice').value;
      const category = document.getElementById('productCategory').value;
      const stock = document.getElementById('productStock').value;
      
      if (!name || !price || !category || !stock) {
        showNotification('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc', 'error');
        return;
      }
      
      if (!imageInput.files[0] && !editingProductId) {
        showNotification('Vui l√≤ng ch·ªçn ·∫£nh s·∫£n ph·∫©m', 'error');
        return;
      }

      try {
        // T·∫°o object s·∫£n ph·∫©m
        const productData = {
          id: editingProductId || Date.now(),
          name,
          price: parseInt(price),
          desc: document.getElementById('productDesc').value.trim(),
          stock: parseInt(stock),
          colors: document.getElementById('productColors').value.trim() || '',
          sizes: document.getElementById('productSizes').value.trim() || '',
          category,
          createdAt: editingProductId ? 
            products.find(p => p.id === editingProductId)?.createdAt || new Date().toISOString() : 
            new Date().toISOString(),
          updatedAt: new Date().toISOString()
        };

        // X·ª≠ l√Ω ·∫£nh n·∫øu c√≥
        if (imageInput.files[0]) {
          productData.image = await readFileAsDataURL(imageInput.files[0]);
        } else if (editingProductId) {
          // Gi·ªØ nguy√™n ·∫£nh c≈© khi ch·ªânh s·ª≠a
          const existingProduct = products.find(p => p.id === editingProductId);
          if (existingProduct) {
            productData.image = existingProduct.image;
          }
        }

        // L∆∞u s·∫£n ph·∫©m
        saveProduct(productData);
      } catch (error) {
        console.error('L·ªói khi th√™m s·∫£n ph·∫©m:', error);
        showNotification('C√≥ l·ªói x·∫£y ra khi th√™m s·∫£n ph·∫©m', 'error');
      }
    });

    // H√†m ƒë·ªçc file ·∫£nh th√†nh Data URL
    function readFileAsDataURL(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    // C·∫≠p nh·∫≠t h√†m saveProduct
    // Thay th·∫ø h√†m saveProduct b·∫±ng ƒëo·∫°n code sau
function saveProduct(productData) {
  let products = JSON.parse(localStorage.getItem('products')) || [];
  
  // ƒê·∫£m b·∫£o ID l√† number
  productData.id = parseInt(productData.id) || Date.now();
  
  if (imageInput.files[0]) {
    // L∆∞u t√™n file thay v√¨ Data URL
    productData.image = 'img/' + imageInput.files[0].name;
  } else if (editingProductId) {
    // Gi·ªØ nguy√™n ·∫£nh c≈© n·∫øu ƒëang ch·ªânh s·ª≠a
    const existingProduct = products.find(p => p.id === editingProductId);
    if (existingProduct) productData.image = existingProduct.image;
  }

  if (editingProductId) {
    const index = products.findIndex(p => p.id === editingProductId);
    if (index !== -1) {
      products[index] = productData;
    } else {
      products.unshift(productData);
    }
  } else {
    products.unshift(productData);
  }
  
  localStorage.setItem('products', JSON.stringify(products));
  showNotification(editingProductId ? 'C·∫≠p nh·∫≠t th√†nh c√¥ng!' : 'Th√™m th√†nh c√¥ng!', 'success');
  resetForm();
  renderProducts();
}

    // Reset form
    function resetForm() {
      productForm.reset();
      document.getElementById('productId').value = '';
      previewImage.src = '';
      previewImage.style.display = 'none';
      fileName.textContent = 'Ch·ªçn ·∫£nh...';
      removeImage.style.display = 'none';
      editingProductId = null;
      document.getElementById('submitBtn').textContent = 'Th√™m s·∫£n ph·∫©m';
      document.getElementById('cancelEdit').style.display = 'none';
    }

    // Hi·ªÉn th·ªã s·∫£n ph·∫©m
    function renderProducts() {
      if (filteredProducts.length === 0) {
        productList.innerHTML = `
          <div class="no-products">
            <img src="img/no-products.png" alt="No products">
            <p>Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o</p>
            <button class="btn btn-primary" onclick="document.getElementById('productForm').scrollIntoView()">Th√™m s·∫£n ph·∫©m m·ªõi</button>
          </div>
        `;
        pagination.style.display = 'none';
        productCount.textContent = '(0 s·∫£n ph·∫©m)';
        return;
      }

      // Ph√¢n trang
      const startIndex = (currentPage - 1) * productsPerPage;
      const endIndex = startIndex + productsPerPage;
      const paginatedProducts = filteredProducts.slice(startIndex, endIndex);

      // Render s·∫£n ph·∫©m
      productList.innerHTML = paginatedProducts.map(product => `
        <div class="product-card-admin" data-id="${product.id}">
          <img src="${product.image}" alt="${product.name}" onerror="this.src='img/no-image.png'">
          <div class="product-info">
            <h4>${product.name}</h4>
            <p class="price">${product.price.toLocaleString()}ƒë</p>
            <p class="category">${getCategoryName(product.category)}</p>
            <p class="stock">T·ªìn kho: ${product.stock}</p>
          </div>
          <div class="product-actions">
            <button class="btn btn-edit" data-id="${product.id}">S·ª≠a</button>
            <button class="btn btn-delete" data-id="${product.id}">X√≥a</button>
          </div>
        </div>
      `).join('');

      // G·∫Øn s·ª± ki·ªán cho c√°c n√∫t
      document.querySelectorAll('.btn-edit').forEach(btn => {
        btn.addEventListener('click', function() {
          editProduct(this.getAttribute('data-id'));
        });
      });

      document.querySelectorAll('.btn-delete').forEach(btn => {
        btn.addEventListener('click', function() {
          showDeleteModal(this.getAttribute('data-id'));
        });
      });

      // Hi·ªÉn th·ªã ph√¢n trang
      const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
      if (totalPages > 1) {
        pagination.style.display = 'flex';
        pageInfo.textContent = `Trang ${currentPage}/${totalPages}`;
        document.getElementById('prevPage').disabled = currentPage === 1;
        document.getElementById('nextPage').disabled = currentPage === totalPages;
      } else {
        pagination.style.display = 'none';
      }

      productCount.textContent = `(${filteredProducts.length} s·∫£n ph·∫©m)`;
    }

    // H√†m hi·ªÉn th·ªã modal x√≥a
    window.showDeleteModal = function(productId) {
      currentProductIdToDelete = productId;
      confirmModal.style.display = 'block';
    };

    // X√°c nh·∫≠n x√≥a
    confirmDeleteBtn.addEventListener('click', function() {
      if (currentProductIdToDelete) {
        deleteProduct(currentProductIdToDelete);
        confirmModal.style.display = 'none';
      }
    });

    // H·ªßy x√≥a
    cancelDeleteBtn.addEventListener('click', function() {
      confirmModal.style.display = 'none';
    });

    // ƒê√≥ng modal
    closeModalBtn.addEventListener('click', function() {
      confirmModal.style.display = 'none';
    });

    // ƒê√≥ng modal khi click ra ngo√†i
    window.addEventListener('click', function(event) {
      if (event.target === confirmModal) {
        confirmModal.style.display = 'none';
      }
    });

    // H√†m x√≥a s·∫£n ph·∫©m
    // H√†m x√≥a s·∫£n ph·∫©m (s·ª≠a l·∫°i)
function deleteProduct(productId) {
  // ƒê·∫£m b·∫£o productId l√† number
  productId = typeof productId === 'string' ? parseInt(productId) : productId;
  
  // L·∫•y danh s√°ch s·∫£n ph·∫©m t·ª´ localStorage (lu√¥n l·∫•y m·ªõi nh·∫•t)
  let products = JSON.parse(localStorage.getItem('products')) || [];
  
  // T·∫°o m·∫£ng m·ªõi kh√¥ng ch·ª©a s·∫£n ph·∫©m c·∫ßn x√≥a
  const updatedProducts = products.filter(p => p.id !== productId);
  
  // L∆∞u l·∫°i v√†o localStorage
  localStorage.setItem('products', JSON.stringify(updatedProducts));
  
  // C·∫≠p nh·∫≠t l·∫°i bi·∫øn to√†n c·ª•c
  products = updatedProducts;
  filteredProducts = [...updatedProducts];
  
  // Reset n·∫øu ƒëang edit s·∫£n ph·∫©m b·ªã x√≥a
  if (editingProductId === productId) {
    resetForm();
  }
  
  showNotification('X√≥a s·∫£n ph·∫©m th√†nh c√¥ng!', 'success');
  renderProducts();
}

// C·∫≠p nh·∫≠t h√†m saveProduct
function saveProduct(productData) {
  // Lu√¥n l·∫•y danh s√°ch m·ªõi nh·∫•t t·ª´ localStorage
  let products = JSON.parse(localStorage.getItem('products')) || [];
  
  if (editingProductId) {
    // C·∫≠p nh·∫≠t s·∫£n ph·∫©m
    const index = products.findIndex(p => p.id === editingProductId);
    if (index !== -1) {
      products[index] = productData;
    } else {
      products.unshift(productData);
    }
  } else {
    // Th√™m s·∫£n ph·∫©m m·ªõi v√†o ƒë·∫ßu m·∫£ng
    products.unshift(productData);
  }
  
  // L∆∞u v√†o localStorage
  localStorage.setItem('products', JSON.stringify(products));
  
  // C·∫≠p nh·∫≠t bi·∫øn to√†n c·ª•c
  products = JSON.parse(localStorage.getItem('products')) || [];
  filteredProducts = [...products];
  
  showNotification(editingProductId ? 'C·∫≠p nh·∫≠t s·∫£n ph·∫©m th√†nh c√¥ng!' : 'Th√™m s·∫£n ph·∫©m th√†nh c√¥ng!', 'success');
  resetForm();
  renderProducts();
}

    // S·ª≠a s·∫£n ph·∫©m
    window.editProduct = function(productId) {
      // ƒê·∫£m b·∫£o productId l√† number
      productId = parseInt(productId);
      
      // L·∫•y d·ªØ li·ªáu t·ª´ localStorage
      const products = JSON.parse(localStorage.getItem('products')) || [];
      
      // T√¨m s·∫£n ph·∫©m theo ID
      const product = products.find(p => p.id === productId);
      
      if (!product) {
        console.error('Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m v·ªõi ID:', productId);
        console.log('Danh s√°ch s·∫£n ph·∫©m hi·ªán c√≥:', products);
        showNotification('Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m ƒë·ªÉ s·ª≠a', 'error');
        return;
      }

      // ƒêi·ªÅn d·ªØ li·ªáu v√†o form
      document.getElementById('productId').value = product.id;
      document.getElementById('productName').value = product.name;
      document.getElementById('productPrice').value = product.price;
      document.getElementById('productDesc').value = product.desc || '';
      document.getElementById('productStock').value = product.stock || 0;
      document.getElementById('productColors').value = product.colors || '';
      document.getElementById('productSizes').value = product.sizes || '';
      document.getElementById('productCategory').value = product.category || '';

      // Hi·ªÉn th·ªã ·∫£nh
      previewImage.src = product.image || '';
      previewImage.style.display = product.image ? 'block' : 'none';
      fileName.textContent = product.image ? '·∫¢nh s·∫£n ph·∫©m' : 'Ch·ªçn ·∫£nh...';
      removeImage.style.display = product.image ? 'block' : 'none';

      editingProductId = product.id;
      document.getElementById('submitBtn').textContent = 'C·∫≠p nh·∫≠t';
      document.getElementById('cancelEdit').style.display = 'inline-block';
      
      // Cu·ªôn ƒë·∫øn form
      productForm.scrollIntoView({ behavior: 'smooth' });
    };

    // L·ªçc v√† s·∫Øp x·∫øp s·∫£n ph·∫©m
    function filterAndSortProducts() {
      const searchTerm = searchInput.value.toLowerCase();
      const sortValue = sortSelect.value;
      
      // L·ªçc theo t·ª´ kh√≥a
      filteredProducts = products.filter(product => 
        product.name.toLowerCase().includes(searchTerm) ||
        (product.desc && product.desc.toLowerCase().includes(searchTerm)) ||
        product.category.toLowerCase().includes(searchTerm)
      );
      
      // S·∫Øp x·∫øp
      switch (sortValue) {
        case 'newest':
          filteredProducts.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
          break;
        case 'oldest':
          filteredProducts.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
          break;
        case 'price_asc':
          filteredProducts.sort((a, b) => a.price - b.price);
          break;
        case 'price_desc':
          filteredProducts.sort((a, b) => b.price - a.price);
          break;
      }
      
      currentPage = 1;
      renderProducts();
    }

    // Hi·ªÉn th·ªã th√¥ng b√°o
    function showNotification(message, type) {
      notification.textContent = message;
      notification.className = `notification ${type}`;
      notification.style.display = 'block';
      
      setTimeout(() => {
        notification.style.display = 'none';
      }, 3000);
    }

    // L·∫•y t√™n danh m·ª•c
    function getCategoryName(category) {
      const categories = {
        dienthoai: 'ƒêi·ªán tho·∫°i',
        quanao: 'Qu·∫ßn √°o',
        giaydep: 'Gi√†y d√©p',
        phukien: 'Ph·ª• ki·ªán',
        khac: 'Kh√°c'
      };
      return categories[category] || category;
    }

    // Ph√¢n trang
    document.getElementById('prevPage').addEventListener('click', function() {
      if (currentPage > 1) {
        currentPage--;
        renderProducts();
      }
    });

    document.getElementById('nextPage').addEventListener('click', function() {
      const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        renderProducts();
      }
    });

    // T√¨m ki·∫øm v√† s·∫Øp x·∫øp
    searchInput.addEventListener('input', filterAndSortProducts);
    sortSelect.addEventListener('change', filterAndSortProducts);

    // H·ªßy ch·ªânh s·ª≠a
    document.getElementById('cancelEdit').addEventListener('click', resetForm);

    // ƒêƒÉng xu·∫•t
    document.getElementById('logoutBtn').addEventListener('click', function(e) {
      e.preventDefault();
      if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën ƒëƒÉng xu·∫•t kh√¥ng?')) {
        localStorage.removeItem('currentUser');
        window.location.href = 'TrangChu.html';
      }
    });

    // L·ªçc theo danh m·ª•c
    document.querySelectorAll('.category-filter').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        
        // C·∫≠p nh·∫≠t active
        document.querySelectorAll('.category-filter').forEach(item => {
          item.classList.remove('active');
        });
        this.classList.add('active');
        
        const category = this.getAttribute('data-category');
        if (category === 'all') {
          filteredProducts = [...products];
        } else {
          filteredProducts = products.filter(p => p.category === category);
        }
        
        currentPage = 1;
        renderProducts();
      });
    });
  }); 
  </script>
</body>
</html>
