<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Rainbow Shop</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Thanh t√¨m ki·∫øm */
    .search-container {
      position: relative;
      width: 40%;
    }
    
    .search-input {
      width: 100%;
      padding: 10px 15px 10px 40px;
      border: 1px solid #5e79fb;
      border-radius: 20px;
      font-size: 14px;
      outline: none;
    }
    
    .search-icon {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #999;
    }
    
    /* User actions */
    .user-actions {
      display: flex;
      align-items: center;
      gap: 25px;
    }
    
    .user-action {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 14px;
      color: #333;
      text-decoration: none;
    }
    
    .cart-count {
      background-color: #7d78ff;
      color: white;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }
    
    /* Layout ch√≠nh */
    .main-container {
      display: flex;
      margin: 20px;
      gap: 20px;
    }
    
    /* Sidebar danh m·ª•c */
    .category-sidebar {
      width: 250px;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      height: fit-content;
    }
    
    .category-sidebar h3 {
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .category-sidebar ul {
      list-style: none;
    }
    
    .category-sidebar li {
      margin-bottom: 10px;
    }
    
    .category-sidebar a {
      text-decoration: none;
      color: #333;
      display: block;
      padding: 8px 10px;
      border-radius: 5px;
      transition: all 0.3s;
    }
    
    .category-sidebar a:hover {
      background-color: #f0f0ff;
      color: #5e79fb;
    }
    
    .category-sidebar a.active {
      background-color: #5e79fb;
      color: white;
    }
    
    /* S·∫£n ph·∫©m */
    .product-content {
      flex: 1;
    }
    
    .product-content h1 {
      font-size: 2.5rem;
      text-align: center;
      margin-bottom: 30px;
      background: linear-gradient(90deg, 
        #ff0000, #ff7f00, #ffff00, #00ff00,
        #0000ff, #4b0082, #9400d3);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      background-size: 400% 100%;
      animation: gradientFlow 5s linear infinite;
    }
    
    .product-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
    }
    
    .product-card {
      background: #fff;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.3s;
      text-decoration: none;
      color: inherit;
    }
    
    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .product-card img {
      width: 100%;
      height: 180px;
      object-fit: contain;
      border-radius: 8px;
      margin-bottom: 10px;
      background: #f8f8f8;
    }
    
    .product-card p {
      margin: 5px 0;
      font-size: 14px;
    }
    
    .product-name {
      font-weight: 600;
      height: 40px;
      overflow: hidden;
      display: -webkit-box;
      -webkit-box-orient: vertical;
    }
    
    .product-price {
      color: #d0011b;
      font-weight: bold;
    }
    
    @keyframes gradientFlow {
      0% { background-position: 0% 50% }
      100% { background-position: 100% 50% }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <a href="TrangChu.html" style="text-decoration: none;">
      <span class="rainbow-text">Rainbow</span>
    </a>
    
    <!-- Thanh t√¨m ki·∫øm -->
    <div class="search-container">
      <span class="search-icon">üîç</span>
      <input type="text" id="searchInput" class="search-input" placeholder="Nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm..." onkeydown="if(event.key === 'Enter') handleSearch()">
    </div>
    
    <!-- User actions -->
    <div class="user-actions">
      <a href="GioHang.html" class="user-action">Gi·ªè h√†ng <span class="cart-count" id="cartCount">0</span></a>
      <a href="DangNhap.html" class="user-action" id="authLink">ƒêƒÉng nh·∫≠p</a>
      <a href="#" class="user-action" id="logoutBtn" style="display:none;">ƒêƒÉng xu·∫•t</a>
    </div>
  </div>
  
  <!-- Main content -->
  <div class="main-container">
    <!-- Danh m·ª•c -->
    <div class="category-sidebar">
      <h3>Danh m·ª•c</h3>
      <ul>
        <li><a href="#" class="category-link" data-category="all">T·∫•t c·∫£ s·∫£n ph·∫©m</a></li>
        <li><a href="#" class="category-link" data-category="dienthoai">ƒêi·ªán tho·∫°i</a></li>
        <li><a href="#" class="category-link" data-category="quanao">Qu·∫ßn √°o</a></li>
        <li><a href="#" class="category-link" data-category="giaydep">Gi√†y d√©p</a></li>
        <li><a href="#" class="category-link" data-category="phukien">Ph·ª• ki·ªán</a></li>
        <li><a href="#" class="category-link" data-category="khac">Kh√°c</a></li>
      </ul>
    </div>
    
    <!-- S·∫£n ph·∫©m -->
    <div class="product-content">
      <h1>S·∫£n ph·∫©m n·ªïi b·∫≠t</h1>
      <div class="product-list" id="productList">
        <!-- S·∫£n ph·∫©m s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
      </div>
    </div>
  </div>
  
  <!-- Footer -->
  <div class="footer">
    <div class="contact-info">Th√¥ng tin li√™n h·ªá: 1900 1000</div>
    <p>¬© 2025 Rainbow Shop</p>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const authLink = document.getElementById("authLink");
      const logoutBtn = document.getElementById("logoutBtn");
      const currentUser = JSON.parse(localStorage.getItem("currentUser"));

      if (currentUser) {
        authLink.style.display = "none";
        logoutBtn.style.display = "inline";
        
        logoutBtn.addEventListener("click", function (e) {
          e.preventDefault();
          if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën ƒëƒÉng xu·∫•t kh√¥ng?")) {
            localStorage.removeItem("currentUser");
            location.href = "TrangChu.html";
          }
        });
      } else {
        logoutBtn.style.display = "none";
        authLink.style.display = "inline";
      }

      updateCartCount();
      renderProducts('all');
      
      if (currentUser?.role === "seller") {
        const userActions = document.querySelector(".user-actions");
        const adminLink = document.createElement("a");
        adminLink.href = "Admin.html";
        adminLink.className = "user-action";
        adminLink.textContent = "Qu·∫£n l√Ω";
        userActions.insertBefore(adminLink, authLink);
      }

      // Th√™m s·ª± ki·ªán click cho c√°c danh m·ª•c
      document.querySelectorAll('.category-link').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const category = this.getAttribute('data-category');
          
          // X√≥a active t·∫•t c·∫£ c√°c link
          document.querySelectorAll('.category-link').forEach(item => {
            item.classList.remove('active');
          });
          
          // Th√™m active cho link ƒë∆∞·ª£c click
          this.classList.add('active');
          
          // Hi·ªÉn th·ªã s·∫£n ph·∫©m theo danh m·ª•c
          renderProducts(category);
        });
      });
    });

    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      document.getElementById("cartCount").textContent = cart.length;
    }

    const categoryNames = {
      dienthoai: "ƒêi·ªán tho·∫°i",
      quanao: "Qu·∫ßn √°o",
      giaydep: "Gi√†y d√©p",
      phukien: "Ph·ª• ki·ªán",
      khac: "Kh√°c"
    };

    const defaultProducts = [
      {
        name: "ƒêi·ªán tho·∫°i Xiaomi",
        price: 3990000,
        image: "xiaomi-mi-9-1-600x600.jpg",
        desc: "Smartphone cao c·∫•p",
        category: "dienthoai"
      },
      {
        name: "√Åo Hoodie Unisex",
        price: 299000,
        image: "img/ao-hoodie-unisex-nam-nu-insidemen-ihd002bz__7__ff4a3abea33141b99dd7dd0ad98039ec.jpg",
        desc: "√Åo hoodie d√†nh cho nam/n·ªØ, ch·∫•t li·ªáu n·ªâ, gi·ªØ ·∫•m t·ªët",
        category: "quanao"
      },
      {
        name: "Gi√†y Th·ªÉ Thao",
        price: 599000,
        image: "img/images.jpg",
        desc: "Gi√†y th·ªÉ thao √™m ch√¢n",
        category: "giaydep"
      },
      {
        name: "·ªêp ƒëi·ªán tho·∫°i iPhone",
        price: 99000,
        image: "img/op-lung-iphone-15-pro-max-uniq-hybrid-magclick-charging-lifepro-xtreme-af-1772.jpg",
        desc: "·ªêp l·ªÅ b·∫Øt camera, b·∫£o v·ªá ch·ªëng tr∆∞·ª£t",
        category: "phukien"
      },
      {
        name: "Qu·∫°t Goojodoq",
        price: 168340,
        image: "img/6f9a32aed03c4908728b041ee310db99.jpg",
        desc: "Qu·∫°t g·∫•p 3 trong 1, 100 c·∫•p ƒë·ªô, c·∫ßm tay si√™u m√°t",
        category: "khac"
      }
    ];

    function renderProducts(category = 'all') {
      const productList = document.getElementById("productList");
      productList.innerHTML = "";

      // L·∫•y t·∫•t c·∫£ s·∫£n ph·∫©m
      const allProducts = [...defaultProducts, ...JSON.parse(localStorage.getItem('products')) || []];
      
      // L·ªçc s·∫£n ph·∫©m theo danh m·ª•c
      const filteredProducts = category === 'all' 
        ? allProducts 
        : allProducts.filter(product => product.category === category);

      // Hi·ªÉn th·ªã s·∫£n ph·∫©m
      if (filteredProducts.length === 0) {
        productList.innerHTML = '<p style="grid-column:1/-1;text-align:center;">Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o trong danh m·ª•c n√†y</p>';
        return;
      }

      filteredProducts.forEach(product => {
        const productCard = document.createElement("a");
        productCard.className = "product-card";
        
        // T·∫°o URL chi ti·∫øt s·∫£n ph·∫©m
        if (defaultProducts.includes(product)) {
          productCard.href = `SanPham.html?name=${encodeURIComponent(product.name)}&price=${product.price}&img=${encodeURIComponent(product.image)}&desc=${encodeURIComponent(product.desc)}`;
        } else {
          const index = allProducts.indexOf(product);
          productCard.href = `SanPham.html?productId=${index}`;
        }
        
        productCard.innerHTML = `
          <img src="${product.image}" alt="${product.name}">
          <p class="product-name">${product.name}</p>
          <p class="product-price">${Number(product.price).toLocaleString()}ƒë</p>
        `;
        productList.appendChild(productCard);
      });
    }

    function handleSearch() {
      const keyword = document.getElementById("searchInput").value.trim().toLowerCase();
      const allProducts = [...defaultProducts, ...JSON.parse(localStorage.getItem('products')) || []];

      const results = allProducts.filter(p =>
        p.name.toLowerCase().includes(keyword) ||
        (p.desc && p.desc.toLowerCase().includes(keyword))
      );

      localStorage.setItem("searchResults", JSON.stringify(results));
      window.location.href = "TimKiem.html";
    }
  </script>
</body>
</html>
